<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="pandas&amp;sql">
<meta property="og:type" content="article">
<meta property="og:title" content="æ•°æ®åˆ†æè‡ªå­¦è¯¾ç¨‹ï¼ˆç¬¬äº”è¯¾ï¼špandas\&amp;sqlï¼‰">
<meta property="og:url" content="http://example.com/2022/05/13/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%87%AA%E5%AD%A6%E8%AF%BE%E7%A8%8B/%E7%AC%AC%E4%BA%94%E8%AF%BE-pandas&sql/index.html">
<meta property="og:site_name" content="Pluto&#39;s blog">
<meta property="og:description" content="pandas&amp;sql">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/image_px_-A7tbW-.png">
<meta property="og:image" content="http://example.com/image/image_ju1C608rlQ.png">
<meta property="article:published_time" content="2022-05-13T15:09:00.709Z">
<meta property="article:modified_time" content="2022-05-13T15:16:59.212Z">
<meta property="article:author" content="Pluto">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="Tableau">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/image_px_-A7tbW-.png">

<link rel="canonical" href="http://example.com/2022/05/13/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%87%AA%E5%AD%A6%E8%AF%BE%E7%A8%8B/%E7%AC%AC%E4%BA%94%E8%AF%BE-pandas&sql/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>æ•°æ®åˆ†æè‡ªå­¦è¯¾ç¨‹ï¼ˆç¬¬äº”è¯¾ï¼špandas\&sqlï¼‰ | Pluto's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Pluto's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>èµ„æº</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/13/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%87%AA%E5%AD%A6%E8%AF%BE%E7%A8%8B/%E7%AC%AC%E4%BA%94%E8%AF%BE-pandas&sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/boji.png">
      <meta itemprop="name" content="Pluto">
      <meta itemprop="description" content="åŠªåŠ›å§ï¼Œå°‘å¹´">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Pluto's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          æ•°æ®åˆ†æè‡ªå­¦è¯¾ç¨‹ï¼ˆç¬¬äº”è¯¾ï¼špandas\&sqlï¼‰
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-05-13 23:09:00 / ä¿®æ”¹æ—¶é—´ï¼š23:16:59" itemprop="dateCreated datePublished" datetime="2022-05-13T23:09:00+08:00">2022-05-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" itemprop="url" rel="index"><span itemprop="name">æ•°æ®åˆ†æ</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>pandas&amp;sql</p>
<span id="more"></span>
<h1 id="çŸ¥è¯†ç‚¹1-å»é‡">çŸ¥è¯†ç‚¹1-å»é‡</h1>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 78%" />
<col style="width: 1%" />
</colgroup>
<thead>
<tr class="header">
<th>pandas</th>
<th>æ³¨é‡Šï¼ˆæ–¹æ³•çš„å‚æ•°åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹ï¼Œæ›´å¤šå‚æ•°å¯è‡ªè¡Œåœ¨jupyter notebook
æŒ‰shift+tabæŸ¥çœ‹ğŸ‘€ ï¼‰</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df.columnã€df['column']</td>
<td>æ¶‰åŠé€‰å–å¤šåˆ—ï¼Œéœ€è¦é‡‡ç”¨åµŒå¥—åˆ—è¡¨å½¢å¼[['x','y']]</td>
<td>column</td>
</tr>
<tr class="even">
<td>df = pd.read_csv('./table_name.csv')
df = pd.read_excel('./table_name.xlsx')</td>
<td><strong>read_csv()</strong>pathï¼šæŒ‡æ˜æ‰€éœ€è¯»å–è¡¨æ ¼æ‰€åœ¨çš„æ–‡ä»¶è·¯å¾„ã€‚è‹¥è¡¨æ ¼ä¸ä»£ç æ–‡ä»¶åœ¨åŒä¸€æ–‡ä»¶å¤¹ï¼Œä»…éœ€'./è¡¨æ ¼åç§°.csv'ã€‚è‹¥ä¸åœ¨åŒä¸€æ–‡ä»¶å¤¹ï¼Œéœ€è¦å³é”®è¡¨æ ¼å±æ€§ï¼ŒæŸ¥çœ‹è¡¨æ ¼è·¯å¾„ï¼Œåœ¨æ–‡ä»¶è·¯å¾„å‰åŠ rï¼Œå¦‚r'C:.csv'ã€‚sepï¼šåˆ†éš”ç¬¦ï¼Œå¸¸è§ä¸ºé€—å·ï¼Œå¦‚sep=','usecolsï¼šè¿”å›æŒ‡å®šçš„åˆ—ï¼Œå¦‚usecols=['æ›å…‰æ•°','è¿›åº—æ•°']encodingï¼šæŒ‡å®šç¼–ç æ ¼å¼ï¼Œå¦‚encoding
=
'gbk'<strong>read_excel</strong>()sheet_nameï¼šæŒ‡å®šè¦è¯»å–çš„sheetï¼Œå¦‚sheet_name='sheet2'index_colï¼šæŒ‡å®šæŸåˆ—ä¸ºç´¢å¼•ï¼Œå¦‚index_col='æ—¥æœŸ'usecolsï¼šè¿”å›æŒ‡å®šçš„åˆ—ï¼Œå¦‚usecols=['æ›å…‰æ•°','è¿›åº—æ•°']</td>
<td>from</td>
</tr>
<tr class="odd">
<td>pd.unique(df.column)
pd.drop_duplicates()</td>
<td>**unique()**å¯¹äºå•ä¸ªå­—æ®µå»é‡ï¼Œå¦‚unique(cpc.æ—¥æœŸ)
**drop_duplicates()**å¯¹äºå¤šä¸ªå­—æ®µå»é‡ï¼Œå¦‚drop_duplicates(['æ›å…‰æ•°','è¿›åº—æ•°'])ã€‚è‹¥å¯¹äºæ•´ä¸ªDataFrameå»é‡ï¼Œå¦‚cpc.drop_duplicates()</td>
<td>distinct</td>
</tr>
</tbody>
</table>
<h2 id="ç­›é€‰é—¨åº—åç§°å¹¶ä¸”å»é‡">ç­›é€‰é—¨åº—åç§°å¹¶ä¸”å»é‡</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">  <span class="keyword">distinct</span>(å¹³å°é—¨åº—åç§°) </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">  ddm.cpc</span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(pd.unique(cpc[<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœå±•ç¤ºï¼š</p>
<p>0 è›™å°è¾£ç«é”…æ¯ï¼ˆåˆç”Ÿæ±‡åº—ï¼‰ 1 è›™å°è¾£ç¾è›™ç«é”…æ¯ï¼ˆå¤§å®å›½é™…åº—ï¼‰ 2
è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆé•¿é£å¤§æ‚¦åŸåº—ï¼‰ 3 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆè™¹å£è¶³çƒåœºåº—ï¼‰ 4
åˆ©èŠ³Â·ä¸€äººé£Ÿå¤§ç›˜é¸¡(å›½å®šè·¯åº—) 5 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(è™¹å£è¶³çƒåœºåº—) 6
è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å®å±±åº—) 7 è›™å°è¾£ç«é”…æ¯(äº”è§’åœºåº—)</p>
<h2
id="ç­›é€‰å‡ºå¹³å°é—¨åº—åç§°ä»¥åŠè®¡ç®—ä¸‹å•ç‡">ç­›é€‰å‡ºå¹³å°é—¨åº—åç§°ï¼Œä»¥åŠè®¡ç®—ä¸‹å•ç‡</h2>
<p>SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">  å¹³å°é—¨åº—åç§°, (é—¨åº—ä¸‹å•é‡<span class="operator">/</span>é—¨åº—è®¿é—®é‡)</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  ddm.cpc</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>pandasï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—æ¯å¤©æ¯ä¸ªé—¨åº—çš„ä¸‹å•ç‡</span></span><br><span class="line">cpc[<span class="string">&#x27;ç¬¦å·&#x27;</span>] = <span class="string">&#x27;%&#x27;</span></span><br><span class="line">cpc[<span class="string">&#x27;ä¸‹å•ç‡&#x27;</span>] = (<span class="built_in">round</span>(cpc.é—¨åº—ä¸‹å•é‡/cpc.é—¨åº—è®¿é—®é‡*<span class="number">100</span>,<span class="number">2</span>)).<span class="built_in">map</span>(<span class="built_in">str</span>).<span class="built_in">str</span>.cat(cpc[<span class="string">&#x27;ç¬¦å·&#x27;</span>])</span><br><span class="line">cpc.head()</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœå±•ç¤ºï¼š</p>
<table>
<thead>
<tr class="header">
<th>updateTime</th>
<th>å¹³å°é—¨åº—åç§°</th>
<th>ä¸‹å•ç‡</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2019/12/12 11:54</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆåˆç”Ÿæ±‡åº—ï¼‰</td>
<td>16.87%</td>
</tr>
<tr class="even">
<td>2019/12/12 11:54</td>
<td>è›™å°è¾£ç¾è›™ç«é”…æ¯ï¼ˆå¤§å®å›½é™…åº—ï¼‰</td>
<td>12.55%</td>
</tr>
<tr class="odd">
<td>2019/12/12 11:54</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆé•¿é£å¤§æ‚¦åŸåº—ï¼‰</td>
<td>18.03%</td>
</tr>
<tr class="even">
<td>2019/12/12 11:54</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆè™¹å£è¶³çƒåœºåº—ï¼‰</td>
<td>19.33%</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæˆ‘ä»¬è¦èšåˆè®¡ç®—å‘¢</span></span><br><span class="line">temp = cpc[[<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>,<span class="string">&#x27;é—¨åº—ä¸‹å•é‡&#x27;</span>,<span class="string">&#x27;é—¨åº—è®¿é—®é‡&#x27;</span>]].groupby(<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>).<span class="built_in">sum</span>()</span><br><span class="line">temp[<span class="string">&#x27;ç¬¦å·&#x27;</span>] = <span class="string">&#x27;%&#x27;</span></span><br><span class="line">temp[<span class="string">&#x27;ä¸‹å•ç‡&#x27;</span>] = (<span class="built_in">round</span>(temp.é—¨åº—ä¸‹å•é‡/temp.é—¨åº—è®¿é—®é‡*<span class="number">100</span>,<span class="number">2</span>)).<span class="built_in">map</span>(<span class="built_in">str</span>).<span class="built_in">str</span>.cat(temp[<span class="string">&#x27;ç¬¦å·&#x27;</span>])</span><br><span class="line">temp.rename(&#123;<span class="string">&#x27;é—¨åº—ä¸‹å•é‡&#x27;</span>: <span class="string">&#x27;é—¨åº—ä¸‹å•æ€»é‡&#x27;</span>, <span class="string">&#x27;é—¨åº—è®¿é—®é‡&#x27;</span>: <span class="string">&#x27;é—¨åº—è®¿é—®æ€»é‡&#x27;</span>&#125;, axis=<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœå±•ç¤ºï¼š</p>
<table>
<colgroup>
<col style="width: 41%" />
<col style="width: 16%" />
<col style="width: 19%" />
<col style="width: 5%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="header">
<th>å¹³å°é—¨åº—åç§°</th>
<th>é—¨åº—ä¸‹å•æ€»é‡</th>
<th>é—¨åº—è®¿é—®æ€»é‡</th>
<th>ç¬¦å·</th>
<th>ä¸‹å•ç‡</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>åˆ©èŠ³Â·ä¸€äººé£Ÿå¤§ç›˜é¸¡(å›½å®šè·¯åº—)</td>
<td>3087.0</td>
<td>20388.0</td>
<td>%</td>
<td>15.14%</td>
</tr>
<tr class="even">
<td>åˆ©èŠ³å¤§ç›˜é¸¡(å›½å®šè·¯åº—)</td>
<td>2858.0</td>
<td>12953.0</td>
<td>%</td>
<td>22.06%</td>
</tr>
<tr class="odd">
<td>æ‹Œå®¢Â·å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>8314.0</td>
<td>31427.0</td>
<td>%</td>
<td>26.45%</td>
</tr>
<tr class="even">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>72.0</td>
<td>441.0</td>
<td>%</td>
<td>16.33%</td>
</tr>
<tr class="odd">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«ï¼ˆæ­¦å®è·¯åº—ï¼‰</td>
<td>2329.0</td>
<td>8590.0</td>
<td>%</td>
<td>27.11%</td>
</tr>
</tbody>
</table>
<h1 id="çŸ¥è¯†ç‚¹2-è¿ç®—ç¬¦æ¡ä»¶">çŸ¥è¯†ç‚¹2-è¿ç®—ç¬¦ï¼ˆæ¡ä»¶ï¼‰</h1>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 17%" />
<col style="width: 59%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="header">
<th>è¿ç®—ç¬¦</th>
<th>pandas</th>
<th>æ³¨é‡Š</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&gt;</td>
<td>df.query('column&gt;x')</td>
<td>é€šè¿‡å­—ç¬¦ä¸²è¡¨è¾¾å¼å¯¹åˆ—è¿›è¡Œç­›é€‰</td>
<td>where column &gt; x</td>
</tr>
<tr class="even">
<td>=</td>
<td>df.query('column=x')</td>
<td></td>
<td>where column = x</td>
</tr>
<tr class="odd">
<td>&lt;</td>
<td>df.query('column&lt;x')</td>
<td></td>
<td>where column &lt; x</td>
</tr>
<tr class="even">
<td>between..and..</td>
<td>df[df.column.between(x,y)]</td>
<td><strong>å‚æ•°</strong>ï¼š<strong>right/left</strong>ï¼šå·¦å³è¾¹ç•Œçš„å€¼ï¼Œå¦‚between(x,y)<strong>inclusive</strong>ï¼šç¡®å®šæ˜¯å¦åŒ…æ‹¬è¾¹ç•Œå€¼ï¼Œè‹¥åŒ…æ‹¬inclusive
= Trueï¼›è‹¥ä¸åŒ…æ‹¬ï¼Œinclusive = Falseã€‚é»˜è®¤ä¸ºTrue</td>
<td>where column between x and y</td>
</tr>
<tr class="odd">
<td>in</td>
<td>df[df.column.isin([x,y,z...])]</td>
<td>åˆ¤æ–­æŒ‡å®šå­—æ®µä¸­çš„å€¼æ˜¯å¦åŒ…å«åœ¨æ‰€ä¼ å…¥çš„åˆ—è¡¨å½“ä¸­ï¼Œå¹¶è¿”å›ä¸€ä¸ªå…¨ä¸ºBoolå€¼çš„Series</td>
<td>where column in (x,y,z...)</td>
</tr>
<tr class="even">
<td>not in</td>
<td>df[~df.column.isin([x,y,z...])]</td>
<td>isnotin()</td>
<td>where column not in (x,y,z...)</td>
</tr>
<tr class="odd">
<td>is null</td>
<td>df[df.column.isnull()]</td>
<td>æ£€æµ‹æŒ‡å®šå­—æ®µçš„ç¼ºå¤±å€¼ï¼Œè‹¥å‡ºç°Nanï¼Œåˆ™æ˜ å°„åˆ°Trueå€¼ï¼Œéç©ºåˆ™æ˜ å°„åˆ°Falseã€‚å¹¶è¿”å›ä¸å­—æ®µå½¢çŠ¶ç›¸åŒçš„Boolå€¼çš„Series</td>
<td>where column is null</td>
</tr>
<tr class="even">
<td>is not null</td>
<td>df[~df.column.isnull()]</td>
<td>notna()</td>
<td>where column is not null</td>
</tr>
<tr class="odd">
<td>and</td>
<td>df.query('x&lt;column&amp;column&lt;y')</td>
<td>pythonä¸­ä½¿ç”¨&amp;è¡¨ç¤º ä¸</td>
<td>where x&lt;column and column &lt;y</td>
</tr>
<tr class="even">
<td>or</td>
<td>df.query('x&lt;column|column&lt;y')</td>
<td>pythonä¸­ä½¿ç”¨|è¡¨ç¤º æˆ–</td>
<td>where x&lt;column or column &lt;y</td>
</tr>
<tr class="odd">
<td>not</td>
<td>åœ¨dfå‰åŠ ä¸€ä¸ª ~</td>
<td>pythonä¸­ä½¿ç”¨~è¡¨ç¤º é</td>
<td>æ”¾åœ¨é…åˆä½¿ç”¨çš„è¿ç®—ç¬¦å‰</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 2%" />
<col style="width: 17%" />
<col style="width: 67%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="header">
<th>æ¨¡ç³ŠæŸ¥è¯¢</th>
<th>pandas</th>
<th>æ³¨é‡Š</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>like</td>
<td>df[df.column.str.contains('xxx')]</td>
<td>åˆ¤æ–­æ‰€ä¼ å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨æˆ‘ä»¬æŒ‡å®šå­—æ®µçš„å†…å®¹ä¸­ï¼Œå¹¶è¿”å›ä¸å­—æ®µå½¢çŠ¶ç›¸åŒçš„Boolå€¼çš„Series<strong>å‚æ•°</strong>ï¼špatï¼šå­—ç¬¦ä¸²ï¼Œå¦‚å·¦ä¾§å®ä¾‹caseï¼šæ˜¯å¦åŒºåˆ†patä¸­çš„å¤§å°å†™ï¼Œè‹¥åŒºåˆ†ï¼Œåˆ™case
= Trueï¼›è‹¥ä¸åŒºåˆ†ï¼Œåˆ™case = Falseã€‚é»˜è®¤ä¸ºTrueï¼ŒåŒºåˆ†ã€‚</td>
<td>where column like '%xxx%'</td>
</tr>
<tr class="even">
<td></td>
<td>df[df.column.str.startswith('x')]</td>
<td>åˆ¤æ–­æŒ‡å®šå­—æ®µçš„å†…å®¹æ˜¯å¦ä»¥ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸ºå¼€å¤´ï¼Œå¹¶è¿”å›ä¸å­—æ®µå½¢çŠ¶ç›¸åŒçš„Boolå€¼çš„Series<strong>å‚æ•°</strong>ï¼špatï¼šå­—ç¬¦ä¸²ï¼Œå¦‚å·¦ä¾§å®ä¾‹</td>
<td>where column like 'x%'</td>
</tr>
<tr class="odd">
<td></td>
<td>df[df.column.str.startswith('x')]</td>
<td>åˆ¤æ–­æŒ‡å®šå­—æ®µçš„å†…å®¹æ˜¯å¦ä»¥ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸ºç»“å°¾ï¼Œå¹¶è¿”å›ä¸å­—æ®µå½¢çŠ¶ç›¸åŒçš„Boolå€¼çš„Series<strong>å‚æ•°</strong>ï¼špatï¼šå­—ç¬¦ä¸²ï¼Œå¦‚å·¦ä¾§å®ä¾‹</td>
<td>where column like '%x'</td>
</tr>
</tbody>
</table>
<h2 id="æŸ¥æ‰¾gmvroi7-ä¸”-gmvroi8-çš„é—¨åº—idè·Ÿåå­—">æŸ¥æ‰¾gmvroi&gt;7 ä¸”
gmvroi&lt;8 çš„é—¨åº—IDè·Ÿåå­—</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  </span><br><span class="line">  é—¨åº—ID,å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">where</span>   </span><br><span class="line">  gmvroi <span class="operator">&lt;</span><span class="number">8.0</span></span><br><span class="line"><span class="keyword">and</span>     </span><br><span class="line">  gmvroi <span class="operator">&gt;</span><span class="number">7.0</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc.query(<span class="string">&#x27;gmvroi&gt;7.0&amp;gmvroi&lt;8.0&#x27;</span>)[[<span class="string">&#x27;é—¨åº—ID&#x27;</span>,<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>]]</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœå±•ç¤º:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>é—¨åº—ID</th>
<th>å¹³å°é—¨åº—åç§°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>8184590</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆåˆç”Ÿæ±‡åº—ï¼‰</td>
</tr>
<tr class="even">
<td>3</td>
<td>8165842</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆè™¹å£è¶³çƒåœºåº—ï¼‰</td>
</tr>
<tr class="odd">
<td>11</td>
<td>8184590</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆåˆç”Ÿæ±‡åº—ï¼‰</td>
</tr>
<tr class="even">
<td>15</td>
<td>2001104355</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å®å±±åº—)</td>
</tr>
</tbody>
</table>
<h2
id="æŸ¥æ‰¾é—¨åº—gmvroiç­‰äº78çš„é—¨åº—idè·Ÿåå­—">æŸ¥æ‰¾é—¨åº—gmvroiç­‰äº[7,8]çš„é—¨åº—IDè·Ÿåå­—</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span>   </span><br><span class="line">  é—¨åº—ID,å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">from</span>   </span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">  gmvroi <span class="keyword">in</span>(<span class="number">7.0</span>,<span class="number">8.0</span>)</span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc[[<span class="string">&#x27;é—¨åº—ID&#x27;</span>,<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>]][cpc.gmvroi.isin([<span class="number">7.0</span>,<span class="number">8.0</span>])]</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>é—¨åº—ID</th>
<th>å¹³å°é—¨åº—åç§°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>378</td>
<td>8052557</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆçœŸå¦‚åº—ï¼‰</td>
</tr>
<tr class="even">
<td>488</td>
<td>2001053699</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å¤§å®åº—)</td>
</tr>
<tr class="odd">
<td>1012</td>
<td>8491999</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆå®å±±åº—ï¼‰</td>
</tr>
<tr class="even">
<td>1064</td>
<td>8491999</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆå®å±±åº—ï¼‰</td>
</tr>
</tbody>
</table>
<h2
id="æŸ¥æ‰¾é—¨åº—å®æ”¶ä¸ºç©ºçš„é—¨åº—idè·Ÿåå­—">æŸ¥æ‰¾é—¨åº—å®æ”¶ä¸ºç©ºçš„é—¨åº—IDè·Ÿåå­—</h2>
<p>sqlï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>   </span><br><span class="line">  é—¨åº—ID,å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">  é—¨åº—å®æ”¶ <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc[[<span class="string">&#x27;é—¨åº—ID&#x27;</span>,<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>]][cpc.é—¨åº—å®æ”¶.isnull()]</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>é—¨åº—ID</th>
<th>å¹³å°é—¨åº—åç§°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>306</td>
<td>2001104355</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å®å±±åº—)</td>
</tr>
<tr class="even">
<td>332</td>
<td>2000555792</td>
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(è™¹å£è¶³çƒåœºåº—)</td>
</tr>
<tr class="odd">
<td>805</td>
<td>8491999</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆå®å±±åº—ï¼‰</td>
</tr>
<tr class="even">
<td>806</td>
<td>8491999</td>
<td>è›™å°è¾£ç«é”…æ¯ï¼ˆå®å±±åº—ï¼‰</td>
</tr>
</tbody>
</table>
<h2 id="æŸ¥æ‰¾åç§°å¸¦æœ‰å®å±±çš„é—¨åº—">æŸ¥æ‰¾åç§°å¸¦æœ‰å®å±±çš„é—¨åº—</h2>
<p>sqlï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  </span><br><span class="line">  <span class="keyword">distinct</span>(å¹³å°é—¨åº—åç§°)</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">  å¹³å°é—¨åº—åç§° <span class="keyword">like</span> <span class="string">&#x27;%å®å±±%&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(cpc[<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>][cpc.å¹³å°é—¨åº—åç§°.<span class="built_in">str</span>.contains(<span class="string">&#x27;å®å±±&#x27;</span>)].unique())</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœå±•ç¤ºï¼š</p>
<p>0 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å®å±±åº—) 1 è›™å°è¾£ç«é”…æ¯ï¼ˆå®å±±åº—ï¼‰ 2
è›™å°è¾£Â·ç¾è›™ç«é”…æ¯éº»è¾£çƒ«(å®å±±åº—)</p>
<h1 id="çŸ¥è¯†ç‚¹3-èšåˆå‡½æ•°">çŸ¥è¯†ç‚¹3-èšåˆå‡½æ•°</h1>
<table>
<thead>
<tr class="header">
<th>èšåˆå‡½æ•°</th>
<th>pandas</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AGV()</td>
<td>df.column.mean()</td>
<td>select avg(column) from df</td>
</tr>
<tr class="even">
<td>COUNT()</td>
<td>df.column.count()</td>
<td>select count(column) from df</td>
</tr>
<tr class="odd">
<td>MAX()</td>
<td>df.column.max()</td>
<td>select max(column) from df</td>
</tr>
<tr class="even">
<td>MIN()</td>
<td>df.column.min()</td>
<td>select min(column) from df</td>
</tr>
<tr class="odd">
<td>SUM()</td>
<td>df.column.sum()</td>
<td>select sum(column) from df</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 2%" />
<col style="width: 44%" />
<col style="width: 45%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th>åˆ†ç»„ç­›é€‰</th>
<th>pandas</th>
<th>æ³¨é‡Š</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>group</td>
<td>df.groupby('column').agg(åˆ—å
=('values','sum'))df.groupby(['column1','column2']).agg(åˆ—å =
('values','sum'))</td>
<td><strong>groupby('column')</strong>ï¼šæŒ‡å®šæˆ‘ä»¬çš„åˆ†ç»„å­—æ®µ<strong>agg()</strong>ï¼šèšåˆå‡½æ•°åˆ—åï¼šæˆ‘ä»¬å¯¹èšåˆå­—æ®µååˆ«å<strong>'value'</strong>ï¼šæ•°å€¼å‹å­—æ®µçš„åå­—<strong>'sum'</strong>ï¼šèšåˆå‡½æ•°çš„åå­—ï¼Œä¹Ÿå¯ä»¥æ˜¯maxã€minç­‰</td>
<td>group by column</td>
</tr>
<tr class="even">
<td>having</td>
<td>df.groupby('column').agg(åˆ—å =
('values','sum')).query('åˆ—å&gt;x')</td>
<td>é€šè¿‡å¯¹åˆ†ç»„èšåˆåå½¢æˆçš„è¡¨æ ¼ï¼Œè¿›è¡Œqueryæ¡ä»¶ç­›é€‰</td>
<td>having sum(value)&gt;x</td>
</tr>
</tbody>
</table>
<h2 id="æŸ¥æ‰¾å„ä¸ªé—¨åº—çš„å¹³å‡å®æ”¶">æŸ¥æ‰¾å„ä¸ªé—¨åº—çš„å¹³å‡å®æ”¶</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  å¹³å°é—¨åº—åç§°,<span class="built_in">avg</span>(é—¨åº—å®æ”¶) <span class="keyword">as</span> å¹³å‡å®æ”¶</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">  å¹³å°é—¨åº—åç§°</span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc.groupby(<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>).agg(å¹³å‡å®æ”¶ = (<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th>å¹³å°é—¨åº—åç§°</th>
<th>å¹³å‡å®æ”¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>åˆ©èŠ³Â·ä¸€äººé£Ÿå¤§ç›˜é¸¡(å›½å®šè·¯åº—)</td>
<td>1167.085227</td>
</tr>
<tr class="even">
<td>åˆ©èŠ³å¤§ç›˜é¸¡(å›½å®šè·¯åº—)</td>
<td>1003.666667</td>
</tr>
<tr class="odd">
<td>æ‹Œå®¢Â·å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>1694.323253</td>
</tr>
<tr class="even">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>798.885000</td>
</tr>
</tbody>
</table>
<h2
id="æŸ¥æ‰¾å®æ”¶10kçš„é—¨åº—åç§°-ä¸-å®æ”¶æŒ‰å®æ”¶é™åº">æŸ¥æ‰¾å®æ”¶&gt;10kçš„é—¨åº—åç§°
ä¸ å®æ”¶ï¼ŒæŒ‰å®æ”¶é™åº</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  å¹³å°é—¨åº—åç§°,<span class="built_in">sum</span>(é—¨åº—å®æ”¶)</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   </span><br><span class="line">  å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">having</span>      </span><br><span class="line">  <span class="built_in">sum</span>(é—¨åº—å®æ”¶)<span class="operator">&gt;</span><span class="number">10000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>    </span><br><span class="line">  <span class="built_in">sum</span>(é—¨åº—å®æ”¶) <span class="keyword">desc</span> </span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc.groupby(<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>).agg(æ€»å’Œ = (<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>)).query(<span class="string">&#x27;æ€»å’Œ&gt;10000&#x27;</span>).sort_values(by = <span class="string">&#x27;æ€»å’Œ&#x27;</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th>å¹³å°é—¨åº—åç§°</th>
<th>æ€»å’Œ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ‹Œå®¢Â·å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>140628.83</td>
</tr>
<tr class="even">
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å®å±±åº—)</td>
<td>101526.14</td>
</tr>
<tr class="odd">
<td>è›™å°è¾£ç«é”…æ¯(äº”è§’åœºåº—)</td>
<td>99578.18</td>
</tr>
<tr class="even">
<td>è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(è™¹å£è¶³çƒåœºåº—)</td>
<td>71286.21</td>
</tr>
</tbody>
</table>
<h1 id="çŸ¥è¯†ç‚¹4-æ’åº">çŸ¥è¯†ç‚¹4-æ’åº</h1>
<table>
<colgroup>
<col style="width: 1%" />
<col style="width: 26%" />
<col style="width: 61%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="header">
<th>æ’åº</th>
<th>pandas</th>
<th>æ³¨é‡Š</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ­£åº</td>
<td>df.sort_values(by = 'column',ascending = True)</td>
<td>å‚æ•°ï¼š
byï¼šé€‰æ‹©æ’åºä¾æ®çš„å­—æ®µã€‚è‹¥éœ€è¦ä¾æ®å¤šåˆ—ï¼Œåˆ™ï¼š['x1','x2']ã€‚
ascendingï¼šé€‰æ‹©æ’åºæ–¹å¼ã€‚è‹¥æ­£åºï¼Œåˆ™ï¼šascending=Trueï¼›è‹¥å€’åºï¼Œåˆ™ï¼šascending=True</td>
<td>order by column asc</td>
</tr>
<tr class="even">
<td>å€’åº</td>
<td>df.sort_values(by = 'column',ascending = False)</td>
<td></td>
<td>order by column desc</td>
</tr>
</tbody>
</table>
<h2
id="æŸ¥çœ‹æ¯ä¸ªæ­¦å®è·¯é—¨åº—çš„å®æ”¶æŒ‰å®æ”¶é™åº">æŸ¥çœ‹æ¯ä¸ªâ€œæ­¦å®è·¯â€é—¨åº—çš„å®æ”¶ï¼ŒæŒ‰å®æ”¶é™åº</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  å¹³å°é—¨åº—åç§°,<span class="built_in">sum</span>(é—¨åº—å®æ”¶)</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">where</span>     </span><br><span class="line">  å¹³å°é—¨åº—åç§° <span class="keyword">like</span> <span class="string">&#x27;%æ­¦å®è·¯%&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   </span><br><span class="line">  å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>   </span><br><span class="line">  <span class="built_in">sum</span>(é—¨åº—å®æ”¶) <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = cpc[cpc.å¹³å°é—¨åº—åç§°.<span class="built_in">str</span>.contains(<span class="string">&#x27;æ­¦å®è·¯&#x27;</span>)]</span><br><span class="line">x.groupby(cpc.å¹³å°é—¨åº—åç§°).agg(å®æ”¶ = (<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>,<span class="string">&#x27;sum&#x27;</span>)).sort_values(by=<span class="string">&#x27;å®æ”¶&#x27;</span>,ascending = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœå±•ç¤ºï¼š</p>
<table>
<thead>
<tr class="header">
<th>å¹³å°é—¨åº—åç§°</th>
<th>å®æ”¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ‹Œå®¢Â·å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>140628.83</td>
</tr>
<tr class="even">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«ï¼ˆæ­¦å®è·¯åº—ï¼‰</td>
<td>36582.48</td>
</tr>
<tr class="odd">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>1597.77</td>
</tr>
</tbody>
</table>
<h1 id="çŸ¥è¯†ç‚¹5-limit">çŸ¥è¯†ç‚¹5-limit</h1>
<table style="width:100%;">
<colgroup>
<col style="width: 23%" />
<col style="width: 39%" />
<col style="width: 12%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="header">
<th>é™åˆ¶</th>
<th>pandas</th>
<th>æ³¨é‡Š</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>limit x</td>
<td>df.head(x)</td>
<td>å–å‰xè¡Œ</td>
<td>limit x</td>
</tr>
<tr class="even">
<td>limit x,y</td>
<td>df[x:y] / df.loc[x:y,'å­—æ®µ']</td>
<td>è·³è¿‡å‰xè¡Œï¼Œå–yè¡Œ</td>
<td>limit x,y</td>
</tr>
<tr class="odd">
<td>limit x offsets y</td>
<td>df[x:y]</td>
<td>è·³è¿‡å‰xè¡Œï¼Œå–yè¡Œ</td>
<td>limit x offsets y</td>
</tr>
</tbody>
</table>
<p> </p>
<h2 id="è·³è¿‡å‰5è¡Œæ˜¾ç¤º5æ¡æ•°æ®">è·³è¿‡å‰5è¡Œï¼Œæ˜¾ç¤º5æ¡æ•°æ®</h2>
<p> sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span>   </span><br><span class="line">  ddm.cpc</span><br><span class="line">limit   </span><br><span class="line">  <span class="number">5</span>,<span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc[<span class="number">5</span>:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>
<h2 id="æŸ¥æ‰¾å‰5è¡Œçš„é—¨åº—åç§°">æŸ¥æ‰¾å‰5è¡Œçš„é—¨åº—åç§°</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">  å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">from</span>   </span><br><span class="line">  ddm.cpc</span><br><span class="line">limit  </span><br><span class="line">  <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc.loc[:<span class="number">5</span>, <span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<p>0 è›™å°è¾£ç«é”…æ¯ï¼ˆåˆç”Ÿæ±‡åº—ï¼‰ 1 è›™å°è¾£ç¾è›™ç«é”…æ¯ï¼ˆå¤§å®å›½é™…åº—ï¼‰ 2
è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆé•¿é£å¤§æ‚¦åŸåº—ï¼‰ 3 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆè™¹å£è¶³çƒåœºåº—ï¼‰ 4
åˆ©èŠ³Â·ä¸€äººé£Ÿå¤§ç›˜é¸¡(å›½å®šè·¯åº—) 5 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(è™¹å£è¶³çƒåœºåº—)</p>
<h2
id="æŸ¥æ‰¾é—¨åº—å¹³å‡å®æ”¶1kçš„é—¨åº—åç§°ä¸å¹³å‡å®æ”¶æ˜¾ç¤ºå‰10æ¡æ•°æ®ç»“æ„æŒ‰ç…§å¹³å‡å®æ”¶é™åº">æŸ¥æ‰¾é—¨åº—å¹³å‡å®æ”¶&gt;1Kçš„é—¨åº—åç§°ä¸å¹³å‡å®æ”¶ï¼Œæ˜¾ç¤ºå‰10æ¡æ•°æ®ï¼Œç»“æ„æŒ‰ç…§å¹³å‡å®æ”¶é™åº</h2>
<p>sqlï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>     </span><br><span class="line">  å¹³å°é—¨åº—åç§°,<span class="built_in">avg</span>(é—¨åº—å®æ”¶) <span class="keyword">as</span> å¹³å‡å®æ”¶</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   </span><br><span class="line">  å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">having</span>      </span><br><span class="line">  å¹³å‡å®æ”¶ <span class="operator">&gt;</span> <span class="number">1000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>   </span><br><span class="line">  å¹³å‡å®æ”¶ <span class="keyword">desc</span></span><br><span class="line">limit       </span><br><span class="line">  <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpc.groupby(<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>).agg(å¹³å‡å®æ”¶ = (<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>)).query(<span class="string">&#x27;å¹³å‡å®æ”¶&gt;1000&#x27;</span>).sort_values(by = <span class="string">&#x27;å¹³å‡å®æ”¶&#x27;</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th>å¹³å°é—¨åº—åç§°</th>
<th>å¹³å‡å®æ”¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ‹Œå®¢Â·å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>1694.323253</td>
</tr>
<tr class="even">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«ï¼ˆæ­¦å®è·¯åº—ï¼‰</td>
<td>1407.018462</td>
</tr>
<tr class="odd">
<td>è›™å°è¾£ç«é”…æ¯</td>
<td>1372.333333</td>
</tr>
<tr class="even">
<td>è›™å°è¾£ç«é”…æ¯(äº”è§’åœºåº—)</td>
<td>1310.239211</td>
</tr>
<tr class="odd">
<td>è›™å°è¾£ç¾è›™ç«é”…æ¯(äº”è§’åœºåº—)</td>
<td>1227.000000</td>
</tr>
</tbody>
</table>
<h1 id="çŸ¥è¯†ç‚¹6-å­æŸ¥è¯¢">çŸ¥è¯†ç‚¹6-å­æŸ¥è¯¢</h1>
<h2
id="æŸ¥æ‰¾å®æ”¶cpc.csv1kçš„é—¨åº—åç§°">æŸ¥æ‰¾å®æ”¶ï¼ˆcpc.csvï¼‰&gt;1Kçš„é—¨åº—åç§°</h2>
<p>sqlï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  </span><br><span class="line">  <span class="keyword">distinct</span> å¹³å°é—¨åº—åç§°</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">where</span>   </span><br><span class="line">  é—¨åº—ID</span><br><span class="line"><span class="keyword">in</span></span><br><span class="line">  (</span><br><span class="line">    <span class="keyword">select</span>  </span><br><span class="line">      é—¨åº—ID</span><br><span class="line">    <span class="keyword">from</span>    </span><br><span class="line">      ddm.cpc</span><br><span class="line">    <span class="keyword">where</span>   </span><br><span class="line">      é—¨åº—å®æ”¶<span class="operator">&gt;</span><span class="number">1000</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = cpc.query(<span class="string">&#x27;é—¨åº—å®æ”¶&gt;1000&#x27;</span>).é—¨åº—ID          <span class="comment">#å­æŸ¥è¯¢æ¡ä»¶a:é—¨åº—å®æ”¶&gt;1kçš„é—¨åº—ID</span></span><br><span class="line">b = cpc[<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>][cpc[<span class="string">&#x27;é—¨åº—ID&#x27;</span>].isin(a)].unique()  <span class="comment">#å°†æ¡ä»¶æ”¾å…¥isin()å½“ä¸­</span></span><br><span class="line">pd.Series(b)</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<p>0 è›™å°è¾£ç«é”…æ¯ï¼ˆåˆç”Ÿæ±‡åº—ï¼‰ 1 è›™å°è¾£ç¾è›™ç«é”…æ¯ï¼ˆå¤§å®å›½é™…åº—ï¼‰ 2
è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆé•¿é£å¤§æ‚¦åŸåº—ï¼‰ 3 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯ï¼ˆè™¹å£è¶³çƒåœºåº—ï¼‰ 4
åˆ©èŠ³Â·ä¸€äººé£Ÿå¤§ç›˜é¸¡(å›½å®šè·¯åº—) 5 è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(è™¹å£è¶³çƒåœºåº—) 6
è›™å°è¾£Â·ç¾è›™ç«é”…æ¯(å®å±±åº—) 7 è›™å°è¾£ç«é”…æ¯(äº”è§’åœºåº—)</p>
<h1 id="çŸ¥è¯†ç‚¹7-è¡¨è¿æ¥">çŸ¥è¯†ç‚¹7-è¡¨è¿æ¥</h1>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 91%" />
<col style="width: 3%" />
</colgroup>
<thead>
<tr class="header">
<th>Pandas</th>
<th>æ³¨é‡Š</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>merge</td>
<td>mergeå¯¹æ ‡æˆ‘ä»¬çš„sqlçš„joinè¯­å¥
left,righté¦–å…ˆä¼ å…¥æˆ‘ä»¬éœ€è¦è¿›è¡Œè¿æ¥çš„ä¸¤è¡¨åç§°
left/right onï¼šå…¶æ¬¡é€‰æ‹©å·¦å³ä¸¤è¡¨çš„è¿æ¥å­—æ®µ
howï¼šæœ€åé€‰æ‹©è¿æ¥æ–¹å¼</td>
<td>join</td>
</tr>
</tbody>
</table>
<h2
id="æŸ¥çœ‹é—¨åº—åç§°shopçš„å®æ”¶cpcè¿æ¥å­—æ®µé—¨åº—id">æŸ¥çœ‹é—¨åº—åç§°ï¼ˆshopï¼‰çš„å®æ”¶ï¼ˆcpcï¼‰ï¼ˆè¿æ¥å­—æ®µï¼šé—¨åº—IDï¼‰</h2>
<p>sqlï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>     </span><br><span class="line">  s.é—¨åº—åç§°,</span><br><span class="line">  <span class="built_in">sum</span>(c.é—¨åº—å®æ”¶)</span><br><span class="line"><span class="keyword">from</span>     </span><br><span class="line">  ddm.cpc c</span><br><span class="line"><span class="keyword">join</span>     </span><br><span class="line">  ddm.shop s</span><br><span class="line"><span class="keyword">on</span>       </span><br><span class="line">  c.é—¨åº—ID <span class="operator">=</span> s.é—¨åº—ID</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   </span><br><span class="line">  s.é—¨åº—åç§°</span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M = pd.merge(cpc,shop,left_on = <span class="string">&#x27;é—¨åº—ID&#x27;</span>,right_on = <span class="string">&#x27;é—¨åº—ID&#x27;</span>,how = <span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line">M.groupby([<span class="string">&#x27;é—¨åº—åç§°&#x27;</span>]).agg(é—¨åº—å®æ”¶ = (<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>,<span class="string">&#x27;sum&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th>é—¨åº—åç§°</th>
<th>é—¨åº—å®æ”¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>äº”è§’åœºåº—</td>
<td>32576771.28</td>
</tr>
<tr class="even">
<td>äº¤å¤§åº—</td>
<td>2480.38</td>
</tr>
<tr class="odd">
<td>å¤§ä¸–ç•Œåº—</td>
<td>1536518.72</td>
</tr>
<tr class="even">
<td>å¤§å®åº—</td>
<td>1135848.24</td>
</tr>
</tbody>
</table>
<h2
id="ç»§ç»­é¢˜1é‡‡ç”¨2ä¸ªè¿æ¥å­—æ®µé—¨åº—idä¸æ—¥æœŸ">ç»§ç»­é¢˜1ï¼Œé‡‡ç”¨2ä¸ªè¿æ¥å­—æ®µï¼šé—¨åº—IDä¸æ—¥æœŸ</h2>
<p>sqlï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>     </span><br><span class="line">  s.é—¨åº—åç§°,</span><br><span class="line">  <span class="built_in">sum</span>(c.é—¨åº—å®æ”¶)</span><br><span class="line"><span class="keyword">from</span>     </span><br><span class="line">  ddm.cpc c</span><br><span class="line"><span class="keyword">join</span>     </span><br><span class="line">  ddm.shop s</span><br><span class="line"><span class="keyword">on</span>       </span><br><span class="line">  c.é—¨åº—ID <span class="operator">=</span> s.é—¨åº—ID</span><br><span class="line"><span class="keyword">and</span>      </span><br><span class="line">  c.æ—¥æœŸ <span class="operator">=</span> s.æ—¥æœŸ</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   </span><br><span class="line">  s.é—¨åº—åç§°</span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M = pd.merge(cpc,shop,left_on = [<span class="string">&#x27;é—¨åº—ID&#x27;</span>,<span class="string">&#x27;æ—¥æœŸ&#x27;</span>],right_on = [<span class="string">&#x27;é—¨åº—ID&#x27;</span>,<span class="string">&#x27;æ—¥æœŸ&#x27;</span>],how = <span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line">M.groupby([<span class="string">&#x27;é—¨åº—åç§°&#x27;</span>]).agg(é—¨åº—å®æ”¶ = (<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>,<span class="string">&#x27;sum&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th>é—¨åº—åç§°</th>
<th>é—¨åº—å®æ”¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>äº”è§’åœºåº—</td>
<td>159994.53</td>
</tr>
<tr class="even">
<td>äº¤å¤§åº—</td>
<td>354.34</td>
</tr>
<tr class="odd">
<td>å¤§å®åº—</td>
<td>9011.00</td>
</tr>
<tr class="even">
<td>å®å±±åº—</td>
<td>236248.07</td>
</tr>
<tr class="odd">
<td>æ€’æ±Ÿè·¯åº—</td>
<td>33258.33</td>
</tr>
<tr class="even">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>178809.08</td>
</tr>
<tr class="odd">
<td>çœŸå¦‚åº—</td>
<td>26326.30</td>
</tr>
<tr class="even">
<td>è™¹å£è¶³çƒåœºåº—</td>
<td>84359.97</td>
</tr>
<tr class="odd">
<td>é¾™é˜³å¹¿åœºåº—</td>
<td>7486.00</td>
</tr>
<tr class="even">
<td>é¾™é˜³è·¯åº—</td>
<td>1607.48</td>
</tr>
</tbody>
</table>
<h1 id="çŸ¥è¯†ç‚¹8-çª—å£å‡½æ•°">çŸ¥è¯†ç‚¹8-çª—å£å‡½æ•°</h1>
<p><img src="/image/image_px_-A7tbW-.png" /></p>
<h2
id="æ¯ä¸€å¤©ä¸åŒé—¨åº—çš„é—¨åº—å®æ”¶æ’åé‡‡ç”¨æ—¥æœŸé—¨åº—å®æ”¶æ­£åºè¾“å‡º">æ¯ä¸€å¤©/ä¸åŒé—¨åº—çš„/é—¨åº—å®æ”¶æ’åï¼Œé‡‡ç”¨æ—¥æœŸã€é—¨åº—å®æ”¶æ­£åºè¾“å‡º</h2>
<p>sql:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  </span><br><span class="line">  æ—¥æœŸ,</span><br><span class="line">  å¹³å°é—¨åº—åç§°,</span><br><span class="line">  é—¨åº—å®æ”¶,</span><br><span class="line">  <span class="built_in">rank</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> æ—¥æœŸ <span class="keyword">order</span> <span class="keyword">by</span> é—¨åº—å®æ”¶ <span class="keyword">desc</span>) <span class="keyword">as</span> rankk</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">  ddm.cpc</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">  æ—¥æœŸ,é—¨åº—å®æ”¶ <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>
<p>pandas:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cpc[<span class="string">&#x27;rank&#x27;</span>] = cpc.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>].rank(method = <span class="string">&#x27;min&#x27;</span>,ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="comment">#è¿™é‡Œç›¸å½“äºrank() over (partition by æ—¥æœŸ order by é—¨åº—å®æ”¶ desc) as rankk</span></span><br><span class="line"></span><br><span class="line">cpc.sort_values(by = [<span class="string">&#x27;æ—¥æœŸ&#x27;</span>,<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>],ascending=[<span class="literal">True</span>,<span class="literal">False</span>])[[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>,<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>,<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>,<span class="string">&#x27;rank&#x27;</span>]]</span><br><span class="line"><span class="comment">#sort_values(by = [&#x27;æ—¥æœŸ&#x27;,&#x27;é—¨åº—å®æ”¶&#x27;],ascending=[True,False]):order by æ—¥æœŸ,é—¨åº—å®æ”¶ desc</span></span><br><span class="line"><span class="comment">#[[&#x27;æ—¥æœŸ&#x27;,&#x27;å¹³å°é—¨åº—åç§°&#x27;,&#x27;é—¨åº—å®æ”¶&#x27;,&#x27;rank&#x27;]]:select  æ—¥æœŸ,å¹³å°é—¨åº—åç§°,é—¨åº—å®æ”¶,rankk</span></span><br></pre></td></tr></table></figure>
<h1 id="çŸ¥è¯†ç‚¹9-æ•°æ®é€è§†è¡¨">çŸ¥è¯†ç‚¹9-æ•°æ®é€è§†è¡¨</h1>
<p><img src="/image/image_ju1C608rlQ.png" /></p>
<h2 id="å„ä¸ªé—¨åº—åœ¨ä¸åŒå¹³å°çš„å•†å®¶å®æ”¶">å„ä¸ªé—¨åº—åœ¨ä¸åŒå¹³å°çš„å•†å®¶å®æ”¶</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">table = pd.pivot_table(cpc, values = [<span class="string">&#x27;é—¨åº—å®æ”¶&#x27;</span>,<span class="string">&#x27;cpcæ€»è´¹ç”¨&#x27;</span>], index = [<span class="string">&#x27;å¹³å°é—¨åº—åç§°&#x27;</span>], columns = [<span class="string">&#x27;å¹³å°i&#x27;</span>], aggfunc = np.<span class="built_in">sum</span>).fillna(<span class="number">0</span>)</span><br><span class="line">table</span><br></pre></td></tr></table></figure>
<p>éƒ¨åˆ†ç»“æœï¼š</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>cpcæ€»è´¹ç”¨</th>
<th></th>
<th>é—¨åº—å®æ”¶</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>å¹³å°i</td>
<td>ç¾å›¢</td>
<td>é¥¿äº†ä¹ˆ</td>
<td>ç¾å›¢</td>
<td>é¥¿äº†ä¹ˆ</td>
</tr>
<tr class="even">
<td>å¹³å°é—¨åº—åç§°</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>åˆ©èŠ³Â·ä¸€äººé£Ÿå¤§ç›˜é¸¡(å›½å®šè·¯åº—)</td>
<td>0.00</td>
<td>16738.51</td>
<td>0.00</td>
<td>51351.75</td>
</tr>
<tr class="even">
<td>åˆ©èŠ³å¤§ç›˜é¸¡(å›½å®šè·¯åº—)</td>
<td>0.00</td>
<td>11198.71</td>
<td>0.00</td>
<td>24088.00</td>
</tr>
<tr class="odd">
<td>æ‹Œå®¢Â·å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>0.00</td>
<td>19624.31</td>
<td>0.00</td>
<td>140628.83</td>
</tr>
<tr class="even">
<td>æ‹Œå®¢å¹²æ‹Œéº»è¾£çƒ«(æ­¦å®è·¯åº—)</td>
<td>0.00</td>
<td>510.90</td>
<td>0.00</td>
<td>1597.77</td>
</tr>
</tbody>
</table>
<h1 id="çŸ¥è¯†ç‚¹10-è¡¨æ ¼åˆå¹¶">çŸ¥è¯†ç‚¹10-è¡¨æ ¼åˆå¹¶</h1>
<p>æ ¸å¿ƒæ€è·¯éƒ½æ˜¯é‡‡ç”¨å¾ªç¯ï¼Œé€ä¸ªæ‹¼æ¥è¡¨æ ¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å½“æƒ³è¦åˆå¹¶ä¸åŒçš„Excelè¡¨æ ¼ï¼ˆæ³¨æ„ï¼Œè¦ä¿è¯æ¯ä¸ªExcelè¡¨æ ¼çš„å­—æ®µç›¸åŒå“¦ï¼‰</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">path = <span class="string">&#x27;./test/&#x27;</span>              <span class="comment">#1ã€path:é€‰æ‹©Excelè¡¨æ ¼æ‰€åœ¨è·¯å¾„</span></span><br><span class="line">files = [i <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(path)]      <span class="comment">#2ã€files = []:åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œå°†è·¯å¾„ä¸­ï¼Œæ–‡ä»¶oræ–‡ä»¶å¤¹çš„åå­—è£…å…¥åˆ—è¡¨</span></span><br><span class="line"><span class="built_in">print</span>(files)                  <span class="comment">#3ã€æŸ¥çœ‹æ˜¯å¦æ­£ç¡®ï¼Œå¦‚ï¼š[&#x27;test1&#x27;,&#x27;test2&#x27;]</span></span><br><span class="line"></span><br><span class="line">Merge = pd.DataFrame()              <span class="comment">#4ã€åˆ›å»ºä¸€ä¸ªç©ºçš„DataFrame</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:                  <span class="comment">#5ã€for:å¾ªç¯éå†æˆ‘ä»¬çš„åç§°åˆ—è¡¨(2)ï¼Œ</span></span><br><span class="line">    df = pd.read_excel(path+i)          <span class="comment">#6ã€read_excel(path+i):è¯»å–ç¬¬files[i]ä»½è¡¨æ ¼ã€‚å¦‚å½“i=0,files[0]=&#x27;sheet1&#x27;</span></span><br><span class="line">    Merge = pd.concat([Merge,df])        <span class="comment">#7ã€concat:å°†dfå†…å®¹æ‹¼æ¥è‡³Mergeå†…</span></span><br><span class="line">Merge.to_excel(path+<span class="string">&#x27;excelåˆå¹¶.xlsx&#x27;</span>,index = <span class="literal">None</span>)  <span class="comment">#8ã€to_excel:éå†ç»“æŸåï¼Œè¾“å‡ºæˆ‘ä»¬åˆå¹¶åçš„è¡¨æ ¼</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å½“æƒ³è¦åˆå¹¶åŒä¸€å¼ Excelè¡¨æ ¼å†…çš„æ‰€æœ‰sheetï¼ˆæ³¨æ„ï¼Œè¦ä¿è¯æ¯ä¸ªsheetçš„å­—æ®µç›¸åŒå“¦ï¼‰</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">name_list = pd.ExcelFile(<span class="string">&#x27;./test/å­¦ä¹ åå•3.xlsx&#x27;</span>)       <span class="comment">#1ã€ExcelFile:ä¼ å…¥Excelè¡¨æ ¼</span></span><br><span class="line">df_list = pd.DataFrame()              <span class="comment">#2ã€åˆ›å»ºä¸€ä¸ªç©ºDataFrame</span></span><br><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> name_list.sheet_names:           <span class="comment">#3ã€for:å¾ªç¯éå†æˆ‘ä»¬çš„åç§°åˆ—è¡¨(1)</span></span><br><span class="line">    df = name_list.parse(sheet_name=sheet)    <span class="comment">#4ã€name_listçš„å±æ€§parse:è¯»å–sheetä¸­çš„å†…å®¹</span></span><br><span class="line">    df_list=pd.concat([df_list,df])        <span class="comment">#5ã€append:æˆ‘ä»¬å°†è¯»å–åˆ°çš„sheetå†…å®¹ï¼Œé™„åŠ åˆ°df_listä¸­</span></span><br><span class="line">df_list.to_excel(<span class="string">&#x27;./test/sheetåˆå¹¶.xlsx&#x27;</span>,index=<span class="literal">False</span>)    <span class="comment">#6ã€å°†df_listä¸­çš„å†…å®¹æŒ‰è¡Œåˆå¹¶ï¼Œè¾“å‡º</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ExcelFile()ï¼šä¼ å…¥ä¸€ä¸ªè¡¨æ ¼çš„è·¯å¾„ï¼Œå¹¶èµ‹äºˆä¸€ä¸ªå¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment">#sheet_namesï¼šä»–æ˜¯ExcelFile()çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå°†Excelå­å·¥ä½œè¡¨çš„åå­—ä»¥åˆ—è¡¨å½¢å¼è¿”å›</span></span><br><span class="line"><span class="comment">#parseï¼šä»–æ˜¯ExcelFile()çš„ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment">#å‚æ•°sheet_nameï¼šä¼ å…¥å­å·¥ä½œè¡¨çš„åç§°ï¼Œå¯ä»¥è¯»å–é‡Œé¢çš„å†…å®¹</span></span><br></pre></td></tr></table></figure>
<h1 id="çŸ¥è¯†ç‚¹11-åˆ é™¤åˆ—">çŸ¥è¯†ç‚¹11-åˆ é™¤åˆ—</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.drop(columns=<span class="string">&#x27;updateTime&#x27;</span>,inplace = <span class="literal">True</span>)<span class="comment">#å½“æˆ‘ä»¬é€šè¿‡ä¸Šä¸€æ­¥ï¼šdf.head()æŸ¥çœ‹æ•°æ®å†…å®¹åï¼Œå¯ä»¥åˆ é™¤æˆ‘ä»¬è®¤ä¸ºä¸éœ€è¦çš„å­—æ®µ</span></span><br><span class="line">    <span class="comment">#inplace--æˆ‘ä»¬ç›´æ¥æ›¿æ¢åŸæœ‰çš„æ•°æ®</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/SQL/" rel="tag"># SQL</a>
              <a href="/tags/Tableau/" rel="tag"># Tableau</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/13/%E5%90%B4%E6%81%A9%E8%BE%BE-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/13-%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B/" rel="prev" title="å´æ©è¾¾-æœºå™¨å­¦ä¹ ï¼ˆåä¸‰ï¼šå¼‚å¸¸æ£€æµ‹ï¼‰">
      <i class="fa fa-chevron-left"></i> å´æ©è¾¾-æœºå™¨å­¦ä¹ ï¼ˆåä¸‰ï¼šå¼‚å¸¸æ£€æµ‹ï¼‰
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/13/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%87%AA%E5%AD%A6%E8%AF%BE%E7%A8%8B/%E7%AC%AC%E4%BA%8C%E8%AF%BE-excel%E5%AE%9E%E6%88%98/" rel="next" title="æ•°æ®åˆ†æè‡ªå­¦è¯¾ç¨‹ï¼ˆç¬¬äºŒè¯¾ï¼šexcelï¼‰ï¼‰">
      æ•°æ®åˆ†æè‡ªå­¦è¯¾ç¨‹ï¼ˆç¬¬äºŒè¯¾ï¼šexcelï¼‰ï¼‰ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B91-%E5%8E%BB%E9%87%8D"><span class="nav-number">1.</span> <span class="nav-text">çŸ¥è¯†ç‚¹1-å»é‡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%9B%E9%80%89%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0%E5%B9%B6%E4%B8%94%E5%8E%BB%E9%87%8D"><span class="nav-number">1.1.</span> <span class="nav-text">ç­›é€‰é—¨åº—åç§°å¹¶ä¸”å»é‡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%9B%E9%80%89%E5%87%BA%E5%B9%B3%E5%8F%B0%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0%E4%BB%A5%E5%8F%8A%E8%AE%A1%E7%AE%97%E4%B8%8B%E5%8D%95%E7%8E%87"><span class="nav-number">1.2.</span> <span class="nav-text">ç­›é€‰å‡ºå¹³å°é—¨åº—åç§°ï¼Œä»¥åŠè®¡ç®—ä¸‹å•ç‡</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B92-%E8%BF%90%E7%AE%97%E7%AC%A6%E6%9D%A1%E4%BB%B6"><span class="nav-number">2.</span> <span class="nav-text">çŸ¥è¯†ç‚¹2-è¿ç®—ç¬¦ï¼ˆæ¡ä»¶ï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BEgmvroi7-%E4%B8%94-gmvroi8-%E7%9A%84%E9%97%A8%E5%BA%97id%E8%B7%9F%E5%90%8D%E5%AD%97"><span class="nav-number">2.1.</span> <span class="nav-text">æŸ¥æ‰¾gmvroi&gt;7 ä¸”
gmvroi&lt;8 çš„é—¨åº—IDè·Ÿåå­—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E9%97%A8%E5%BA%97gmvroi%E7%AD%89%E4%BA%8E78%E7%9A%84%E9%97%A8%E5%BA%97id%E8%B7%9F%E5%90%8D%E5%AD%97"><span class="nav-number">2.2.</span> <span class="nav-text">æŸ¥æ‰¾é—¨åº—gmvroiç­‰äº[7,8]çš„é—¨åº—IDè·Ÿåå­—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E9%97%A8%E5%BA%97%E5%AE%9E%E6%94%B6%E4%B8%BA%E7%A9%BA%E7%9A%84%E9%97%A8%E5%BA%97id%E8%B7%9F%E5%90%8D%E5%AD%97"><span class="nav-number">2.3.</span> <span class="nav-text">æŸ¥æ‰¾é—¨åº—å®æ”¶ä¸ºç©ºçš„é—¨åº—IDè·Ÿåå­—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%90%8D%E7%A7%B0%E5%B8%A6%E6%9C%89%E5%AE%9D%E5%B1%B1%E7%9A%84%E9%97%A8%E5%BA%97"><span class="nav-number">2.4.</span> <span class="nav-text">æŸ¥æ‰¾åç§°å¸¦æœ‰å®å±±çš„é—¨åº—</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B93-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="nav-number">3.</span> <span class="nav-text">çŸ¥è¯†ç‚¹3-èšåˆå‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%90%84%E4%B8%AA%E9%97%A8%E5%BA%97%E7%9A%84%E5%B9%B3%E5%9D%87%E5%AE%9E%E6%94%B6"><span class="nav-number">3.1.</span> <span class="nav-text">æŸ¥æ‰¾å„ä¸ªé—¨åº—çš„å¹³å‡å®æ”¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%AE%9E%E6%94%B610k%E7%9A%84%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0-%E4%B8%8E-%E5%AE%9E%E6%94%B6%E6%8C%89%E5%AE%9E%E6%94%B6%E9%99%8D%E5%BA%8F"><span class="nav-number">3.2.</span> <span class="nav-text">æŸ¥æ‰¾å®æ”¶&gt;10kçš„é—¨åº—åç§°
ä¸ å®æ”¶ï¼ŒæŒ‰å®æ”¶é™åº</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B94-%E6%8E%92%E5%BA%8F"><span class="nav-number">4.</span> <span class="nav-text">çŸ¥è¯†ç‚¹4-æ’åº</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%AF%8F%E4%B8%AA%E6%AD%A6%E5%AE%81%E8%B7%AF%E9%97%A8%E5%BA%97%E7%9A%84%E5%AE%9E%E6%94%B6%E6%8C%89%E5%AE%9E%E6%94%B6%E9%99%8D%E5%BA%8F"><span class="nav-number">4.1.</span> <span class="nav-text">æŸ¥çœ‹æ¯ä¸ªâ€œæ­¦å®è·¯â€é—¨åº—çš„å®æ”¶ï¼ŒæŒ‰å®æ”¶é™åº</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B95-limit"><span class="nav-number">5.</span> <span class="nav-text">çŸ¥è¯†ç‚¹5-limit</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%B3%E8%BF%87%E5%89%8D5%E8%A1%8C%E6%98%BE%E7%A4%BA5%E6%9D%A1%E6%95%B0%E6%8D%AE"><span class="nav-number">5.1.</span> <span class="nav-text">è·³è¿‡å‰5è¡Œï¼Œæ˜¾ç¤º5æ¡æ•°æ®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%89%8D5%E8%A1%8C%E7%9A%84%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0"><span class="nav-number">5.2.</span> <span class="nav-text">æŸ¥æ‰¾å‰5è¡Œçš„é—¨åº—åç§°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E9%97%A8%E5%BA%97%E5%B9%B3%E5%9D%87%E5%AE%9E%E6%94%B61k%E7%9A%84%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0%E4%B8%8E%E5%B9%B3%E5%9D%87%E5%AE%9E%E6%94%B6%E6%98%BE%E7%A4%BA%E5%89%8D10%E6%9D%A1%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%8C%89%E7%85%A7%E5%B9%B3%E5%9D%87%E5%AE%9E%E6%94%B6%E9%99%8D%E5%BA%8F"><span class="nav-number">5.3.</span> <span class="nav-text">æŸ¥æ‰¾é—¨åº—å¹³å‡å®æ”¶&gt;1Kçš„é—¨åº—åç§°ä¸å¹³å‡å®æ”¶ï¼Œæ˜¾ç¤ºå‰10æ¡æ•°æ®ï¼Œç»“æ„æŒ‰ç…§å¹³å‡å®æ”¶é™åº</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B96-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">6.</span> <span class="nav-text">çŸ¥è¯†ç‚¹6-å­æŸ¥è¯¢</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%AE%9E%E6%94%B6cpc.csv1k%E7%9A%84%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0"><span class="nav-number">6.1.</span> <span class="nav-text">æŸ¥æ‰¾å®æ”¶ï¼ˆcpc.csvï¼‰&gt;1Kçš„é—¨åº—åç§°</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B97-%E8%A1%A8%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.</span> <span class="nav-text">çŸ¥è¯†ç‚¹7-è¡¨è¿æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%97%A8%E5%BA%97%E5%90%8D%E7%A7%B0shop%E7%9A%84%E5%AE%9E%E6%94%B6cpc%E8%BF%9E%E6%8E%A5%E5%AD%97%E6%AE%B5%E9%97%A8%E5%BA%97id"><span class="nav-number">7.1.</span> <span class="nav-text">æŸ¥çœ‹é—¨åº—åç§°ï¼ˆshopï¼‰çš„å®æ”¶ï¼ˆcpcï¼‰ï¼ˆè¿æ¥å­—æ®µï¼šé—¨åº—IDï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%A7%E7%BB%AD%E9%A2%981%E9%87%87%E7%94%A82%E4%B8%AA%E8%BF%9E%E6%8E%A5%E5%AD%97%E6%AE%B5%E9%97%A8%E5%BA%97id%E4%B8%8E%E6%97%A5%E6%9C%9F"><span class="nav-number">7.2.</span> <span class="nav-text">ç»§ç»­é¢˜1ï¼Œé‡‡ç”¨2ä¸ªè¿æ¥å­—æ®µï¼šé—¨åº—IDä¸æ—¥æœŸ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B98-%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="nav-number">8.</span> <span class="nav-text">çŸ¥è¯†ç‚¹8-çª—å£å‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AF%8F%E4%B8%80%E5%A4%A9%E4%B8%8D%E5%90%8C%E9%97%A8%E5%BA%97%E7%9A%84%E9%97%A8%E5%BA%97%E5%AE%9E%E6%94%B6%E6%8E%92%E5%90%8D%E9%87%87%E7%94%A8%E6%97%A5%E6%9C%9F%E9%97%A8%E5%BA%97%E5%AE%9E%E6%94%B6%E6%AD%A3%E5%BA%8F%E8%BE%93%E5%87%BA"><span class="nav-number">8.1.</span> <span class="nav-text">æ¯ä¸€å¤©&#x2F;ä¸åŒé—¨åº—çš„&#x2F;é—¨åº—å®æ”¶æ’åï¼Œé‡‡ç”¨æ—¥æœŸã€é—¨åº—å®æ”¶æ­£åºè¾“å‡º</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B99-%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="nav-number">9.</span> <span class="nav-text">çŸ¥è¯†ç‚¹9-æ•°æ®é€è§†è¡¨</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%84%E4%B8%AA%E9%97%A8%E5%BA%97%E5%9C%A8%E4%B8%8D%E5%90%8C%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%95%86%E5%AE%B6%E5%AE%9E%E6%94%B6"><span class="nav-number">9.1.</span> <span class="nav-text">å„ä¸ªé—¨åº—åœ¨ä¸åŒå¹³å°çš„å•†å®¶å®æ”¶</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B910-%E8%A1%A8%E6%A0%BC%E5%90%88%E5%B9%B6"><span class="nav-number">10.</span> <span class="nav-text">çŸ¥è¯†ç‚¹10-è¡¨æ ¼åˆå¹¶</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B911-%E5%88%A0%E9%99%A4%E5%88%97"><span class="nav-number">11.</span> <span class="nav-text">çŸ¥è¯†ç‚¹11-åˆ é™¤åˆ—</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Pluto"
      src="/images/boji.png">
  <p class="site-author-name" itemprop="name">Pluto</p>
  <div class="site-description" itemprop="description">åŠªåŠ›å§ï¼Œå°‘å¹´</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">157</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022-5 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pluto</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
